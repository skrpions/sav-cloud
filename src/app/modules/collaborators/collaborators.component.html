<div class="collaborators-page">
  <!-- Sidebar -->
  <app-sidebar 
    (itemClicked)="onSidebarItemClicked($event)"
    (collapseChanged)="onSidebarCollapseChanged($event)">
  </app-sidebar>

  <!-- Main Content -->
  <div class="main-content" [class.sidebar-collapsed]="isSidebarCollapsed()">
    <!-- Header -->
    <app-header (searchChanged)="onSearchChanged($event)"></app-header>

    <!-- Content Area -->
    <div class="content-area">
      @if (showForm()) {
        <!-- Form View -->
        <div class="form-view">
          <div class="form-header">
            <button 
              mat-icon-button 
              class="back-button"
              (click)="onFormCancelled()"
              matTooltip="Volver a la lista">
              <mat-icon>arrow_back</mat-icon>
            </button>
            <h2 class="form-title">
              {{ isEditMode() ? ('collaborators.editCollaborator' | translate) : ('collaborators.addNew' | translate) }}
            </h2>
          </div>

          <app-collaborator-form
            [collaborator]="selectedCollaborator()"
            [isEditMode]="isEditMode()"
            (formSubmitted)="onFormSubmitted()"
            (formCancelled)="onFormCancelled()">
          </app-collaborator-form>
        </div>
      } @else {
        <!-- List View -->
        <div class="list-view">
          <!-- Action Header -->
          <div class="action-header">
            <button 
              mat-raised-button 
              color="primary" 
              class="add-button"
              (click)="onAddNewCollaborator()">
              <mat-icon>add</mat-icon>
              {{ 'collaborators.addNew' | translate }}
            </button>
          </div>

          <!-- Collaborators List -->
          <div class="collaborators-container">
            @if (isLoading()) {
              <!-- Loading State -->
              <div class="loading-container">
                <mat-spinner diameter="40"></mat-spinner>
                <p>Cargando colaboradores...</p>
              </div>
            } @else if (filteredCollaborators().length === 0) {
              <!-- Empty State -->
              <div class="empty-state">
                <mat-icon class="empty-icon">people_outline</mat-icon>
                <h3>{{ searchTerm() ? ('collaborators.noResults' | translate) : 'No hay colaboradores registrados' }}</h3>
                <p>{{ searchTerm() ? 'Intenta con otros términos de búsqueda' : 'Comienza agregando tu primer colaborador' }}</p>
                @if (!searchTerm()) {
                  <button 
                    mat-raised-button 
                    color="primary"
                    (click)="onAddNewCollaborator()">
                    <mat-icon>add</mat-icon>
                    {{ 'collaborators.addNew' | translate }}
                  </button>
                }
              </div>
            } @else {
              <!-- Collaborators Grid -->
              <div class="collaborators-grid">
                @for (collaborator of filteredCollaborators(); track collaborator.id) {
                  <div class="collaborator-card-modern">
                    <!-- Card Header with Avatar and Basic Info -->
                    <div class="card-header">
                      <div class="collaborator-avatar">
                        <mat-icon>person</mat-icon>
                      </div>
                      <div class="collaborator-basic-info">
                        <div class="name-with-status">
                          <h3 class="collaborator-name">{{ getFullName(collaborator) }}</h3>
                          <div class="status-indicator" 
                               [class.active]="collaborator.is_active"
                               [class.inactive]="!collaborator.is_active">
                          </div>
                        </div>
                        <div class="collaborator-phone">
                          <mat-icon class="phone-icon">phone</mat-icon>
                          <span>{{ collaborator.phone }}</span>
                        </div>
                      </div>
                    </div>

                    <!-- Card Actions -->
                    <div class="card-actions">
                      <button 
                        mat-icon-button 
                        matTooltip="Ver detalles"
                        class="action-btn view-btn"
                        (click)="onViewCollaborator(collaborator)">
                        <mat-icon>visibility</mat-icon>
                      </button>
                      <button 
                        mat-icon-button 
                        matTooltip="Editar"
                        class="action-btn edit-btn"
                        (click)="onEditCollaborator(collaborator)">
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button 
                        mat-icon-button 
                        matTooltip="Eliminar"
                        class="action-btn delete-btn"
                        (click)="onDeleteCollaborator(collaborator)">
                        <mat-icon>delete</mat-icon>
                      </button>
                    </div>
                  </div>
                }
              </div>
            }
          </div>
        </div>
      }
    </div>
  </div>
</div> 